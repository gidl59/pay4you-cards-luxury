{% extends "base.html" %}
{% block title %}Dashboard Admin{% endblock %}
{% block content %}

<h2 class="title">Agenti registrati</h2>

<a class="btn primary" href="{{ url_for('admin_edit') }}">+ Nuovo agente</a>

<table class="table card glass">
  <tr>
    <th>Nome</th>
    <th>Slug</th>
    <th>Telefoni</th>
    <th>Email</th>
    <th>Azioni</th>
  </tr>

  {% for a in agents %}
  <tr>
    <td>{{ a.name }}</td>
    <td><a href="{{ url_for('public_card', slug=a.slug) }}" target="_blank">{{ a.slug }}</a></td>

    <td>{{ a.phone_mobile }}{% if a.phone_office %} / {{ a.phone_office }}{% endif %}</td>
    <td>{{ a.emails }}</td>

    <td>
      <a class="btn" href="{{ url_for('admin_edit', slug=a.slug) }}">Modifica</a>

      <form method="post" action="{{ url_for('admin_delete', slug=a.slug) }}"
            style="display:inline" onsubmit="return confirm('Eliminare {{ a.name }}?')">
        <button type="submit" class="btn danger">Elimina</button>
      </form>

      <a class="btn" href="{{ url_for('qr_png', slug=a.slug) }}" target="_blank">QR</a>
      <a class="btn" href="{{ url_for('vcard', slug=a.slug) }}" target="_blank">vCard</a>
      <a class="btn" href="{{ url_for('stats', slug=a.slug) }}" target="_blank">Stats</a>

    </td>
  </tr>
  {% endfor %}
</table>

{% endblock %}
