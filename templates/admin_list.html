{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="card glass">
  <h2>Agenti</h2>

  <a class="btn primary" href="{{ url_for('admin_new') }}">+ Nuovo agente</a>

  {% if agents %}
  <table class="table">
    <tr>
      <th>Nome</th>
      <th>Slug</th>
      <th>Telefoni</th>
      <th>Website</th>
      <th>Azioni</th>
    </tr>
    {% for a in agents %}
    <tr>
      <td>{{ a.name }}</td>
      <td>
        <a href="{{ url_for('public_card', slug=a.slug) }}" target="_blank">
          {{ a.slug }}
        </a>
      </td>
      <td>
        {{ a.phone_mobile }}
        {% if a.phone_office %} / {{ a.phone_office }}{% endif %}
      </td>
      <td>{{ a.websites }}</td>
      <td class="actions">
        <a class="btn" href="{{ url_for('admin_edit', slug=a.slug) }}">Modifica</a>
        <form method="post"
              action="{{ url_for('admin_delete', slug=a.slug) }}"
              onsubmit="return confirm('Eliminare {{ a.name }}?')">
          <button type="submit" class="btn danger">Elimina</button>
        </form>
        <a class="btn"
           href="{{ url_for('qr_png', slug=a.slug) }}"
           target="_blank">QR</a>
        <a class="btn"
           href="{{ url_for('vcard', slug=a.slug) }}"
           target="_blank">vCard</a>
      </td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
    <p>Nessun agente ancora inserito.</p>
  {% endif %}
</div>
{% endblock %}
