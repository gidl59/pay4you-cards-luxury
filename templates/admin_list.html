{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}

<h2>Agenti</h2>

<a class="btn primary" href="{{ url_for('admin_new') }}">+ Nuovo agente</a>

<table class="table card glass">
  <tr>
    <th>Nome</th>
    <th>Slug</th>
    <th>Telefoni</th>
    <th>Website</th>
    <th>Azioni</th>
  </tr>

  {% for a in agents %}
  <tr>
    <td>{{ a.name }}</td>

    <!-- LINK pubblico alla card -->
    <td>
      <a href="{{ url_for('public_card', slug=a.slug) }}" target="_blank">
        {{ a.slug }}
      </a>
    </td>

    <!-- Telefoni -->
    <td>
      {{ a.phone_mobile }}
      {% if a.phone_office %}
        / {{ a.phone_office }}
      {% endif %}
    </td>

    <!-- Website -->
    <td>{{ a.websites }}</td>

    <td>
      <!-- Modifica -->
      <a class="btn" href="{{ url_for('admin_edit', slug=a.slug) }}">Modifica</a>

      <!-- Elimina -->
      <form method="post" action="{{ url_for('admin_delete', slug=a.slug) }}" style="display:inline" onsubmit="return confirm('Eliminare {{ a.name }}?')">
        <button type="submit" class="btn danger">Elimina</button>
      </form>

      <!-- ðŸŸ¦ QR PERSONALE FUNZIONANTE -->
      <a class="btn" href="{{ url_for('qr_personal', slug=a.slug) }}" target="_blank">QR</a>

      <!-- vCard -->
      <a class="btn" href="{{ url_for('vcard', slug=a.slug) }}" target="_blank">vCard</a>
    </td>
  </tr>
  {% endfor %}

</table>

{% endblock %}
