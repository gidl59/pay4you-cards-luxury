{% extends "base.html" %}
{% block title %}{{ agent.name or "Scheda" }}{% endblock %}
{% block content %}
<div class="card glass">
  <div style="display:flex; gap:24px; align-items:flex-start; flex-wrap:wrap;">
    <div style="width:140px; height:140px; border-radius:50%; overflow:hidden; background:#111;">
      {% if agent.photo_url %}
        <img src="{{ agent.photo_url }}" alt="photo" style="width:100%;height:100%;object-fit:cover;">
      {% else %}
        <div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#666;">no photo</div>
      {% endif %}
    </div>

    <div style="min-width:260px;">
      <h2 style="margin:0 0 6px 0;">{{ agent.name }}</h2>
      {% if agent.company %}<div>{{ agent.company }}</div>{% endif %}
      {% if agent.role %}<div>{{ agent.role }}</div>{% endif %}
      {% if agent.bio %}<p style="margin-top:8px;">{{ agent.bio }}</p>{% endif %}

      <div class="grid" style="margin-top:10px;">
        {% if agent.phone_mobile %}<a class="btn" href="tel:{{ agent.phone_mobile|replace(' ','') }}">ğŸ“± Chiama</a>{% endif %}
        {% if agent.emails %}<a class="btn" href="mailto:{{ agent.emails.split(',')[0].strip() }}">âœ‰ï¸ Email</a>{% endif %}
        <a class="btn" href="{{ url_for('vcard', slug=agent.slug) }}">â¬‡ï¸ vCard</a>
      </div>
    </div>
  </div>

  <hr>

  {% if agent.websites %}
    <h3>Link</h3>
    <ul>
      {% for u in agent.websites.split(',') if u.strip() %}
        <li><a href="{{ u|ensure_http }}" target="_blank" rel="noopener">{{ u }}</a></li>
      {% endfor %}
    </ul>
  {% endif %}

  {% set gallery = (agent.gallery_urls or '').split(',') | select('string') | list %}
  {% if gallery and gallery[0] %}
    <h3>Galleria</h3>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:10px;">
      {% for g in gallery if g.strip() %}
        <div style="width:100%;aspect-ratio:1/1;overflow:hidden;border-radius:12px;background:#111;">
          <img src="{{ g }}" alt="img" style="width:100%;height:100%;object-fit:cover;">
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {% set pdfs = [agent.pdf1_url, agent.pdf2_url, agent.pdf3_url, agent.pdf4_url] %}
  {% if pdfs | select('string') | list %}
    <h3 style="margin-top:16px;">Documenti</h3>
    <ul>
      {% for p in pdfs if p %}
        <li><a href="{{ p }}" target="_blank" rel="noopener">ğŸ“„ Apri PDF</a></li>
      {% endfor %}
    </ul>
  {% endif %}
</div>
{% endblock %}
