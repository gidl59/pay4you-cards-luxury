{% extends "base.html" %}{% block title %}{{ agent.name }}{% endblock %}
{% block content %}
<div class="card glass">
  <div class="grid" style="align-items:center">
    <div style="text-align:center">
      <div style="
        width:160px;height:160px;margin:auto;border-radius:999px;overflow:hidden;
        background:#111;display:flex;align-items:center;justify-content:center;">
        {% if agent.photo_url %}
          <img src="{{ agent.photo_url }}" alt="{{ agent.name }}" style="width:100%;height:100%;object-fit:cover;">
        {% else %}
          <div style="color:#777">Nessuna foto</div>
        {% endif %}
      </div>
    </div>
    <div>
      <h2 style="margin:0">{{ agent.name }}</h2>
      {% if agent.company %}<div>{{ agent.company }}</div>{% endif %}
      {% if agent.role %}<div>{{ agent.role }}</div>{% endif %}
      {% if agent.bio %}<p style="margin-top:8px">{{ agent.bio }}</p>{% endif %}

      <ul class="plain">
        {% if agent.phone_mobile %}<li>ğŸ“± <a href="tel:{{ agent.phone_mobile }}">{{ agent.phone_mobile }}</a></li>{% endif %}
        {% if agent.phone_office %}<li>â˜ï¸ <a href="tel:{{ agent.phone_office }}">{{ agent.phone_office }}</a></li>{% endif %}
        {% if agent.emails %}
          {% for e in agent.emails.split(",") %}
            {% set e2 = e.strip() %}
            {% if e2 %}<li>âœ‰ï¸ <a href="mailto:{{ e2 }}">{{ e2 }}</a></li>{% endif %}
          {% endfor %}
        {% endif %}
        {% if agent.websites %}
          {% for w in agent.websites.split(",") %}
            {% set w2 = w.strip() %}
            {% if w2 %}<li>ğŸŒ <a href="{{ w2|ensure_http }}" target="_blank" rel="noopener">{{ w2 }}</a></li>{% endif %}
          {% endfor %}
        {% endif %}
      </ul>

      <p>
        <a class="btn" href="{{ url_for('vcard', slug=agent.slug) }}">Salva in Rubrica</a>
        <a class="btn" href="{{ url_for('qr_png', slug=agent.slug) }}" target="_blank">QR personale</a>
      </p>
    </div>
  </div>
</div>

{% set gallery = (agent.gallery_urls or '').split(',') %}
{% set gallery = [g.strip() for g in gallery if g.strip()] %}
{% if gallery %}
  <h3>Galleria</h3>
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;">
    {% for g in gallery %}
      <div style="border-radius:14px;overflow:hidden;background:#111;height:140px">
        <img src="{{ g }}" alt="img" style="width:100%;height:100%;object-fit:cover;">
      </div>
    {% endfor %}
  </div>
{% endif %}

{% set pdfs = [agent.pdf1_url, agent.pdf2_url, agent.pdf3_url, agent.pdf4_url] %}
{% set pdfs = [p for p in pdfs if p] %}
{% if pdfs %}
  <h3>Documenti</h3>
  <ul class="plain">
    {% for p in pdfs %}
      <li>ğŸ“„ <a href="{{ p|ensure_http }}" target="_blank" rel="noopener">Apri PDF {{ loop.index }}</a></li>
    {% endfor %}
  </ul>
{% endif %}
{% endblock %}
